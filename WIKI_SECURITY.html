<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Security Architecture | Device Fingerprinting Docs</title>
    <style>
        :root {
            --slate-900: #0f172a;
            --slate-800: #1e293b;
            --slate-700: #334155;
            --slate-600: #475569;
            --slate-200: #e2e8f0;
            --slate-100: #f1f5f9;
            --brand: #2563eb;
            --brand-dark: #1e40af;
            --brand-soft: rgba(37, 99, 235, 0.12);
            --radius-md: 12px;
            --radius-sm: 8px;
            --shadow-lg: 0 24px 60px rgba(15, 23, 42, 0.18);
        }

        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background: linear-gradient(135deg, #0f172a, #111827);
            color: var(--slate-900);
        }

        .page {
            display: grid;
            grid-template-columns: 300px minmax(0, 1fr);
            min-height: 100vh;
        }

        .sidebar {
            position: sticky;
            top: 0;
            align-self: start;
            min-height: 100vh;
            padding: 32px 28px;
            background: linear-gradient(160deg, rgba(30, 64, 175, 0.95), rgba(8, 47, 73, 0.95));
            color: #f8fafc;
            box-shadow: inset -1px 0 0 rgba(148, 163, 184, 0.12);
        }

        .brand {
            font-size: 1.35rem;
            font-weight: 600;
            line-height: 1.4;
            margin-bottom: 28px;
        }

        .brand a {
            color: inherit;
            text-decoration: none;
        }

        .nav-title {
            text-transform: uppercase;
            font-size: 0.72rem;
            letter-spacing: 0.12em;
            margin-bottom: 18px;
            color: rgba(226, 232, 240, 0.7);
        }

        .nav-list {
            list-style: none;
            padding: 0;
            margin: 0;
            display: grid;
            gap: 6px;
        }

        .nav-item a {
            display: block;
            padding: 10px 12px;
            border-radius: var(--radius-sm);
            color: rgba(248, 250, 252, 0.88);
            text-decoration: none;
            font-size: 0.95rem;
            transition: background 0.2s ease, color 0.2s ease;
        }

        .nav-item a:hover {
            background: rgba(148, 163, 184, 0.18);
            color: #fff;
        }

        .nav-item.active a {
            background: rgba(37, 99, 235, 0.95);
            color: #fff;
            box-shadow: 0 10px 25px rgba(37, 99, 235, 0.35);
        }

        .content {
            padding: 56px 72px;
            background: linear-gradient(180deg, rgba(15, 23, 42, 0.02), rgba(15, 23, 42, 0.06));
        }

        .content-inner {
            max-width: 960px;
            margin: 0 auto;
            background: #fff;
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-lg);
            padding: 56px 56px 40px;
        }

        .page-header {
            margin-bottom: 36px;
            border-bottom: 1px solid var(--slate-200);
            padding-bottom: 24px;
        }

        .page-header h1 {
            font-size: 2.2rem;
            margin: 0 0 12px;
            color: var(--slate-900);
        }

        .page-meta {
            font-size: 0.9rem;
            color: var(--slate-600);
        }

        .doc-toc {
            background: var(--slate-100);
            border-radius: var(--radius-md);
            padding: 24px 24px 16px;
            margin-bottom: 32px;
            border: 1px solid rgba(148, 163, 184, 0.3);
        }

        .doc-toc strong {
            display: block;
            font-size: 0.95rem;
            margin-bottom: 12px;
            color: var(--slate-700);
            text-transform: uppercase;
            letter-spacing: 0.08em;
        }

        .doc-toc ul {
            margin: 0;
            padding-left: 20px;
            color: var(--slate-700);
        }

        .doc-toc li {
            margin-bottom: 6px;
        }

        article {
            color: var(--slate-800);
            font-size: 1rem;
            line-height: 1.75;
        }

        article h2 {
            margin-top: 40px;
            margin-bottom: 16px;
            font-size: 1.55rem;
            color: var(--slate-900);
        }

        article h3 {
            margin-top: 28px;
            margin-bottom: 12px;
            font-size: 1.25rem;
            color: var(--slate-800);
        }

        article h4 {
            margin-top: 24px;
            margin-bottom: 10px;
            font-size: 1.05rem;
            color: var(--slate-700);
            text-transform: uppercase;
            letter-spacing: 0.04em;
        }

        article p {
            margin: 0 0 16px;
        }

        article code {
            background: rgba(37, 99, 235, 0.08);
            color: var(--brand-dark);
            padding: 2px 6px;
            border-radius: 6px;
            font-size: 0.92rem;
        }

        pre {
            background: #0f172a;
            color: #f8fafc;
            padding: 20px 24px;
            border-radius: var(--radius-sm);
            overflow-x: auto;
            font-size: 0.95rem;
            line-height: 1.6;
            margin: 24px 0;
        }

        pre code {
            background: none;
            padding: 0;
            color: inherit;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 28px 0;
            border: 1px solid rgba(148, 163, 184, 0.4);
            border-radius: var(--radius-sm);
            overflow: hidden;
        }

        th, td {
            padding: 14px 16px;
            text-align: left;
            border-bottom: 1px solid rgba(148, 163, 184, 0.28);
        }

        th {
            background: var(--brand);
            color: #fff;
            font-weight: 600;
            border-bottom: none;
        }

        tr:nth-child(even) td {
            background: rgba(148, 163, 184, 0.08);
        }

        blockquote {
            margin: 24px 0;
            padding: 18px 24px;
            border-left: 4px solid var(--brand);
            background: var(--brand-soft);
            border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
            color: var(--slate-700);
            font-style: italic;
        }

        a {
            color: var(--brand-dark);
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        .pager {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 48px;
            padding-top: 24px;
            border-top: 1px solid var(--slate-200);
            gap: 16px;
        }

        .pager-link {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 16px;
            border-radius: var(--radius-sm);
            background: rgba(37, 99, 235, 0.08);
            color: var(--brand-dark);
            font-weight: 600;
        }

        .pager-link:hover {
            background: rgba(37, 99, 235, 0.18);
            text-decoration: none;
        }

        .page-footer {
            margin-top: 32px;
            font-size: 0.88rem;
            color: var(--slate-600);
        }

        .no-nav {
            justify-content: flex-end;
        }

        @media (max-width: 1080px) {
            .page {
                grid-template-columns: minmax(0, 1fr);
            }

            .sidebar {
                position: relative;
                min-height: auto;
                border-radius: 0 0 var(--radius-md) var(--radius-md);
            }

            .content {
                padding: 32px 24px;
            }

            .content-inner {
                padding: 36px 26px;
            }
        }
    </style>
</head>
<body>
    <div class="page">
        <aside class="sidebar">
            <div class="brand"><a href="WIKI_HOME.html">Device Fingerprinting Docs</a></div>
            <div class="nav-title">Documentation</div>
            <ul class="nav-list"><li class="nav-item"><a href="WIKI_HOME.html">Device Fingerprinting Library - Documentation</a></li>
<li class="nav-item"><a href="WIKI_API_CORE.html">API Reference - Core</a></li>
<li class="nav-item"><a href="WIKI_BASIC_EXAMPLES.html">Basic Examples</a></li>
<li class="nav-item"><a href="WIKI_DEPLOYMENT.html">Deployment Guide</a></li>
<li class="nav-item"><a href="WIKI_INSTALLATION.html">Installation Guide</a></li>
<li class="nav-item"><a href="WIKI_PQC.html">Post-Quantum Cryptography (PQC) Guide</a></li>
<li class="nav-item"><a href="WIKI_QUICK_START.html">Quick Start Guide</a></li>
<li class="nav-item active"><a href="WIKI_SECURITY.html">Security Architecture</a></li></ul>
        </aside>
        <section class="content">
            <div class="content-inner">
                <header class="page-header">
                    <h1>Security Architecture</h1>
                    <div class="page-meta">Generated on 2025-11-05 20:17</div>
                </header>
                <aside class="doc-toc"><strong>On this page</strong><ul>
<li><a href="#table-of-contents">ğŸ“‹ Table of Contents</a></li>
<li><a href="#security-overview">Security Overview</a><ul>
<li><a href="#security-layers">Security Layers</a></li>
<li><a href="#security-assessment">Security Assessment</a></li>
</ul>
</li>
<li><a href="#cryptographic-architecture">Cryptographic Architecture</a><ul>
<li><a href="#algorithms-used">Algorithms Used</a><ul>
<li><a href="#post-quantum-cryptography-pqc">Post-Quantum Cryptography (PQC)</a></li>
<li><a href="#classical-cryptography">Classical Cryptography</a></li>
</ul>
</li>
<li><a href="#hybrid-mode">Hybrid Mode</a></li>
</ul>
</li>
<li><a href="#threat-model">Threat Model</a><ul>
<li><a href="#threats-protected-against">Threats Protected Against</a><ul>
<li><a href="#1-license-piracy">âœ… 1. License Piracy</a></li>
<li><a href="#2-token-tampering">2. Token Tampering</a></li>
<li><a href="#3-replay-attacks">3. Replay Attacks</a></li>
<li><a href="#4-quantum-computing-attacks">4. Quantum Computing Attacks</a></li>
<li><a href="#5-vm-cloning">5. VM Cloning</a></li>
<li><a href="#6-hardware-emulation">6. Hardware Emulation</a></li>
</ul>
</li>
<li><a href="#known-limitations">Known Limitations</a><ul>
<li><a href="#1-physical-hardware-access">1. Physical Hardware Access</a></li>
<li><a href="#2-rootadmin-compromise">2. Root/Admin Compromise</a></li>
<li><a href="#3-side-channel-attacks">3. Side-Channel Attacks</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#security-features">Security Features</a><ul>
<li><a href="#1-token-binding">1. Token Binding</a></li>
<li><a href="#2-signature-verification">2. Signature Verification</a></li>
<li><a href="#3-tamper-detection">3. Tamper Detection</a></li>
<li><a href="#4-secure-storage">4. Secure Storage</a></li>
<li><a href="#5-key-rotation">5. Key Rotation</a></li>
</ul>
</li>
<li><a href="#best-practices">Best Practices</a><ul>
<li><a href="#secure-implementation">Secure Implementation</a><ul>
<li><a href="#1-always-use-token-binding">âœ… 1. Always Use Token Binding</a></li>
<li><a href="#2-enable-pqc-protection">âœ… 2. Enable PQC Protection</a></li>
<li><a href="#3-validate-confidence-scores">âœ… 3. Validate Confidence Scores</a></li>
<li><a href="#4-implement-rate-limiting">âœ… 4. Implement Rate Limiting</a></li>
<li><a href="#5-secure-error-handling">âœ… 5. Secure Error Handling</a></li>
<li><a href="#6-use-encrypted-storage">âœ… 6. Use Encrypted Storage</a></li>
<li><a href="#7-implement-audit-logging">âœ… 7. Implement Audit Logging</a></li>
</ul>
</li>
<li><a href="#deployment-security">Deployment Security</a><ul>
<li><a href="#1-code-obfuscation">âœ… 1. Code Obfuscation</a></li>
<li><a href="#2-secure-distribution">âœ… 2. Secure Distribution</a></li>
<li><a href="#3-update-mechanism">âœ… 3. Update Mechanism</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#compliance">Compliance</a><ul>
<li><a href="#gdpr-compliance">GDPR Compliance</a></li>
<li><a href="#soc-2-iso-27001">SOC 2 / ISO 27001</a></li>
<li><a href="#pci-dss-payment-card-industry">PCI DSS (Payment Card Industry)</a></li>
</ul>
</li>
<li><a href="#security-checklist">Security Checklist</a><ul>
<li><a href="#pre-deployment-checklist">Pre-Deployment Checklist</a></li>
<li><a href="#runtime-security-checklist">Runtime Security Checklist</a></li>
</ul>
</li>
<li><a href="#next-steps">Next Steps</a></li>
</ul></aside>
                <article>
                    <p>Comprehensive guide to the security architecture and best practices.</p>
<h2 id="table-of-contents">ğŸ“‹ Table of Contents</h2>
<ul>
<li><a href="#security-overview">Security Overview</a></li>
<li><a href="#cryptographic-architecture">Cryptographic Architecture</a></li>
<li><a href="#threat-model">Threat Model</a></li>
<li><a href="#security-features">Security Features</a></li>
<li><a href="#best-practices">Best Practices</a></li>
<li><a href="#compliance">Compliance</a></li>
</ul>
<hr />
<h2 id="security-overview">Security Overview</h2>
<h3 id="security-layers">Security Layers</h3>
<p>The Device Fingerprinting library implements multiple security layers:</p>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Application Layer                   â”‚
â”‚  (Your application using the library)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     API Layer                           â”‚
â”‚  (DeviceFingerprinter, HybridPQC)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Security Layer                      â”‚
â”‚  â€¢ Token Binding                        â”‚
â”‚  â€¢ Signature Verification               â”‚
â”‚  â€¢ Tamper Detection                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Cryptographic Layer                 â”‚
â”‚  â€¢ PQC (Dilithium3, Kyber1024)         â”‚
â”‚  â€¢ Classical (SHA3-256, AES-256-GCM)   â”‚
â”‚  â€¢ Hybrid Mode                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Storage Layer                       â”‚
â”‚  â€¢ Encrypted Storage                    â”‚
â”‚  â€¢ Secure Key Management                â”‚
â”‚  â€¢ HSM Support (optional)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 id="security-assessment">Security Assessment</h3>
<table>
<thead>
<tr>
<th>Component</th>
<th>Status</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Cryptography</strong></td>
<td>Compliant</td>
<td>Uses NIST-approved algorithms</td>
</tr>
<tr>
<td><strong>Code Security</strong></td>
<td>Verified</td>
<td>Analyzed with Bandit and CodeQL</td>
</tr>
<tr>
<td><strong>Dependency Security</strong></td>
<td>Current</td>
<td>No known vulnerabilities as of Nov 2025</td>
</tr>
<tr>
<td><strong>Input Validation</strong></td>
<td>Implemented</td>
<td>Validates all user inputs</td>
</tr>
<tr>
<td><strong>Error Handling</strong></td>
<td>Secure</td>
<td>Prevents information disclosure</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="cryptographic-architecture">Cryptographic Architecture</h2>
<h3 id="algorithms-used">Algorithms Used</h3>
<h4 id="post-quantum-cryptography-pqc">Post-Quantum Cryptography (PQC)</h4>
<pre><code class="language-python">from device_fingerprinting.hybrid_pqc import HybridPQC

pqc = HybridPQC()
info = pqc.get_info()

print(f&quot;Algorithm: {info['algorithm']}&quot;)
# Output: Dilithium3 (NIST Level 3)
</code></pre>
<p><strong>PQC Algorithms:</strong>
- <strong>Dilithium3</strong>: Digital signatures (NIST Level 3 = AES-192)
- <strong>Kyber1024</strong>: Key encapsulation (NIST Level 5 = AES-256)
- <strong>Status</strong>: NIST standardized (2024)
- <strong>Quantum Resistance</strong>: Protected against Shor's algorithm</p>
<h4 id="classical-cryptography">Classical Cryptography</h4>
<p><strong>Hashing:</strong>
- SHA3-256 (primary)
- SHA-256 (compatibility)
- BLAKE2b (performance)</p>
<p><strong>Encryption:</strong>
- AES-256-GCM (authenticated encryption)
- ChaCha20-Poly1305 (alternative)</p>
<p><strong>Key Derivation:</strong>
- Argon2id (password-based)
- HKDF-SHA256 (key expansion)</p>
<p><strong>MACs:</strong>
- HMAC-SHA3-256 (primary)
- HMAC-SHA256 (compatibility)</p>
<h3 id="hybrid-mode">Hybrid Mode</h3>
<p>The library uses <strong>hybrid cryptography</strong> by default:</p>
<pre><code class="language-python">from device_fingerprinting.hybrid_pqc import HybridPQC

pqc = HybridPQC()

# Hybrid signature combines:
# 1. Classical HMAC-SHA3-256
# 2. PQC Dilithium3
# Both must verify for signature to be valid

data = &quot;sensitive_data&quot;
signature = pqc.sign(data)  # Hybrid signature

# Verification requires BOTH classical AND PQC to pass
is_valid = pqc.verify(data, signature)
</code></pre>
<p><strong>Benefits:</strong>
- âœ… Protected if classical crypto remains secure
- âœ… Protected if PQC remains secure<br />
- âœ… Only vulnerable if BOTH are broken
- âœ… Future-proof security</p>
<hr />
<h2 id="threat-model">Threat Model</h2>
<h3 id="threats-protected-against">Threats Protected Against</h3>
<h4 id="1-license-piracy">âœ… 1. License Piracy</h4>
<p><strong>Threat:</strong> User copies license to different device</p>
<p><strong>Protection:</strong></p>
<pre><code class="language-python">from device_fingerprinting import DeviceFingerprinter

fp = DeviceFingerprinter()

# Bind license to device
bound_token = fp.bind_token(&quot;LICENSE-KEY&quot;)

# Verification fails on different device
is_valid = fp.verify_token(bound_token)  # False on different device
</code></pre>
<p><strong>Security Level:</strong> High effectiveness</p>
<h4 id="2-token-tampering">2. Token Tampering</h4>
<p><strong>Threat:</strong> Attacker modifies bound token</p>
<p><strong>Protection:</strong></p>
<pre><code class="language-python">from device_fingerprinting.hybrid_pqc import HybridPQC

pqc = HybridPQC()

# Cryptographic signature
data = &quot;license:ABC-123&quot;
signature = pqc.sign(data)

# Tampering detected
tampered_data = &quot;license:ABC-999&quot;
is_valid = pqc.verify(tampered_data, signature)  # False
</code></pre>
<p><strong>Security Level:</strong> Enhanced with hybrid cryptography</p>
<h4 id="3-replay-attacks">3. Replay Attacks</h4>
<p><strong>Threat:</strong> Attacker intercepts and reuses valid token</p>
<p><strong>Protection:</strong></p>
<pre><code class="language-python">from device_fingerprinting import DeviceFingerprinter
from datetime import datetime, timedelta

fp = DeviceFingerprinter()

# Include timestamp in binding
metadata = {
    'timestamp': datetime.now().isoformat(),
    'expires_at': (datetime.now() + timedelta(days=365)).isoformat()
}

bound_token = fp.bind_token(&quot;LICENSE&quot;, metadata=metadata)

# Verify timestamp on each check
# (implement in your application logic)
</code></pre>
<p><strong>Security Level:</strong> Effective when combined with timestamp validation</p>
<h4 id="4-quantum-computing-attacks">4. Quantum Computing Attacks</h4>
<p><strong>Threat:</strong> Future quantum computers break classical crypto</p>
<p><strong>Protection:</strong></p>
<pre><code class="language-python">from device_fingerprinting.hybrid_pqc import HybridPQC

# PQC protection enabled by default
pqc = HybridPQC()

# Dilithium3 is quantum-resistant
signature = pqc.sign(data)
</code></pre>
<p><strong>Security Level:</strong> NIST Level 3 security strength</p>
<h4 id="5-vm-cloning">5. VM Cloning</h4>
<p><strong>Threat:</strong> User clones virtual machine</p>
<p><strong>Protection:</strong></p>
<pre><code class="language-python">from device_fingerprinting import DeviceFingerprinter

# Use advanced mode + network + USB
fp = DeviceFingerprinter(
    advanced_mode=True,
    include_network=True,
    include_usb=True
)

result = fp.generate()

# Check confidence - VM clones may have lower scores
if result.confidence_score &lt; 0.8:
    print(&quot;âš ï¸ Possible VM clone detected&quot;)
</code></pre>
<p><strong>Security Level:</strong> Moderate - determined attackers may bypass</p>
<h4 id="6-hardware-emulation">6. Hardware Emulation</h4>
<p><strong>Threat:</strong> Attacker emulates hardware characteristics</p>
<p><strong>Protection:</strong></p>
<pre><code class="language-python">from device_fingerprinting import DeviceFingerprinter

# Enable ML-based anomaly detection
fp = DeviceFingerprinter(
    enable_ml=True,
    advanced_mode=True
)

result = fp.generate()

# ML can detect suspicious patterns
if hasattr(result, 'anomaly_score') and result.anomaly_score &gt; 0.7:
    print(&quot;âš ï¸ Anomaly detected - possible emulation&quot;)
</code></pre>
<p><strong>Security Level:</strong> Moderate - effectiveness depends on ML model training</p>
<h3 id="known-limitations">Known Limitations</h3>
<h4 id="1-physical-hardware-access">1. Physical Hardware Access</h4>
<p>The library cannot prevent:
- Physical theft of device
- Hardware modifications by expert technicians
- Direct memory access attacks</p>
<p><strong>Mitigation:</strong> Implement additional security layers such as HSM, TPM, or secure boot</p>
<h4 id="2-rootadmin-compromise">2. Root/Admin Compromise</h4>
<p>If attacker has root/admin access:
- Can modify system to spoof hardware IDs
- Can extract keys from memory
- Can disable security features</p>
<p><strong>Mitigation:</strong> Apply code obfuscation, anti-debugging techniques, and runtime integrity checks</p>
<h4 id="3-side-channel-attacks">3. Side-Channel Attacks</h4>
<p>Advanced attacks like:
- Timing attacks (partially mitigated)
- Power analysis (PQC has protection)
- Cache attacks</p>
<p><strong>Mitigation:</strong> Use HSM for critical operations</p>
<hr />
<h2 id="security-features">Security Features</h2>
<h3 id="1-token-binding">1. Token Binding</h3>
<pre><code class="language-python">from device_fingerprinting import DeviceFingerprinter

fp = DeviceFingerprinter()

# Cryptographically bind token to device
license_key = &quot;ABC-123-XYZ&quot;
bound_token = fp.bind_token(license_key)

# Token includes:
# - Device fingerprint (hashed)
# - License key (encrypted)
# - HMAC signature
# - Timestamp
# - Random salt

# Verification requires:
# 1. Correct device (fingerprint match)
# 2. Valid signature (not tampered)
# 3. Correct decryption (authentic token)
</code></pre>
<h3 id="2-signature-verification">2. Signature Verification</h3>
<pre><code class="language-python">from device_fingerprinting.hybrid_pqc import HybridPQC

pqc = HybridPQC()

# Multi-layer signature
data = &quot;sensitive_data&quot;
signature = pqc.sign(data)

# Verification process:
# 1. Classical HMAC-SHA3-256 verification
# 2. PQC Dilithium3 verification
# 3. Timestamp validation (if included)
# 4. Metadata integrity check

is_valid = pqc.verify(data, signature)
</code></pre>
<h3 id="3-tamper-detection">3. Tamper Detection</h3>
<pre><code class="language-python">from device_fingerprinting.hybrid_pqc import HybridPQC

pqc = HybridPQC()

# Protect critical data
config_data = '{&quot;max_devices&quot;: 1, &quot;features&quot;: [&quot;premium&quot;]}'
signature = pqc.sign(config_data)

# Store both
save_config(config_data, signature)

# Later: verify integrity
loaded_config = load_config()
loaded_signature = load_signature()

if pqc.verify(loaded_config, loaded_signature):
    print(&quot;âœ… Configuration intact&quot;)
else:
    print(&quot;âŒ TAMPERING DETECTED - Configuration modified!&quot;)
    # Take action: reset to defaults, alert admin, etc.
</code></pre>
<h3 id="4-secure-storage">4. Secure Storage</h3>
<pre><code class="language-python">from device_fingerprinting.secure_storage import SecureStorage

# Encrypted storage for sensitive data
storage = SecureStorage()

# Store encrypted
storage.store('license_token', bound_token)
storage.store('fingerprint', fingerprint)

# Retrieve encrypted
token = storage.retrieve('license_token')

# Data is encrypted at rest with:
# - AES-256-GCM encryption
# - Unique per-installation key
# - IV/nonce for each entry
</code></pre>
<h3 id="5-key-rotation">5. Key Rotation</h3>
<pre><code class="language-python">from device_fingerprinting.hybrid_pqc import HybridPQC

class KeyRotationManager:
    def __init__(self):
        self.current_pqc = HybridPQC()
        self.rotation_interval = 90 * 24 * 3600  # 90 days

    def rotate_keys(self):
        &quot;&quot;&quot;Generate new PQC keys&quot;&quot;&quot;
        # Create new PQC instance (new keys)
        new_pqc = HybridPQC()

        # Re-sign all critical data with new keys
        # ...

        self.current_pqc = new_pqc
        return new_pqc.get_info()
</code></pre>
<hr />
<h2 id="best-practices">Best Practices</h2>
<h3 id="secure-implementation">Secure Implementation</h3>
<h4 id="1-always-use-token-binding">âœ… 1. Always Use Token Binding</h4>
<pre><code class="language-python"># âŒ BAD: Store raw license key
license_key = &quot;ABC-123&quot;
save_to_file(license_key)  # Insecure!

# âœ… GOOD: Bind to device
fp = DeviceFingerprinter()
bound_token = fp.bind_token(license_key)
save_to_file(bound_token)  # Secure!
</code></pre>
<h4 id="2-enable-pqc-protection">âœ… 2. Enable PQC Protection</h4>
<pre><code class="language-python"># âŒ BAD: Classical crypto only
fp = DeviceFingerprinter()
bound_token = fp.bind_token(license_key)

# âœ… GOOD: Add PQC signature
from device_fingerprinting.hybrid_pqc import HybridPQC

fp = DeviceFingerprinter()
pqc = HybridPQC()

result = fp.generate()
binding_data = f&quot;{license_key}:{result.fingerprint}&quot;
signature = pqc.sign(binding_data)

# Store both
save_license({
    'bound_token': fp.bind_token(license_key),
    'pqc_signature': signature
})
</code></pre>
<h4 id="3-validate-confidence-scores">âœ… 3. Validate Confidence Scores</h4>
<pre><code class="language-python"># âœ… Check confidence before trusting fingerprint
result = fp.generate()

if result.confidence_score &lt; 0.7:
    print(&quot;âš ï¸ Low confidence - hardware may have changed&quot;)
    # Request additional verification
    # Log security event
    # Or deny access
elif result.confidence_score &lt; 0.9:
    print(&quot;âš ï¸ Medium confidence - minor changes detected&quot;)
    # Allow but log for review
else:
    print(&quot;âœ… High confidence&quot;)
</code></pre>
<h4 id="4-implement-rate-limiting">âœ… 4. Implement Rate Limiting</h4>
<pre><code class="language-python">from datetime import datetime, timedelta
from collections import defaultdict

class RateLimiter:
    def __init__(self):
        self.attempts = defaultdict(list)
        self.max_attempts = 5
        self.window = 300  # 5 minutes

    def check_rate_limit(self, identifier):
        now = datetime.now()
        cutoff = now - timedelta(seconds=self.window)

        # Remove old attempts
        self.attempts[identifier] = [
            t for t in self.attempts[identifier]
            if t &gt; cutoff
        ]

        # Check limit
        if len(self.attempts[identifier]) &gt;= self.max_attempts:
            return False

        self.attempts[identifier].append(now)
        return True

# Usage
limiter = RateLimiter()

def verify_license(license_key):
    if not limiter.check_rate_limit(license_key):
        print(&quot;âŒ Rate limit exceeded - possible attack&quot;)
        return False

    # Proceed with verification
    # ...
</code></pre>
<h4 id="5-secure-error-handling">âœ… 5. Secure Error Handling</h4>
<pre><code class="language-python"># âŒ BAD: Expose internal details
try:
    is_valid = fp.verify_token(bound_token)
except Exception as e:
    print(f&quot;Error: {e}&quot;)  # May leak sensitive info!

# âœ… GOOD: Generic error messages
try:
    is_valid = fp.verify_token(bound_token)
except Exception as e:
    # Log detailed error internally
    logger.error(f&quot;Verification failed: {e}&quot;, exc_info=True)

    # Show generic message to user
    print(&quot;Verification failed. Please contact support.&quot;)
</code></pre>
<h4 id="6-use-encrypted-storage">âœ… 6. Use Encrypted Storage</h4>
<pre><code class="language-python">from device_fingerprinting.secure_storage import SecureStorage

# âœ… Store sensitive data encrypted
storage = SecureStorage()

storage.store('license_token', bound_token)
storage.store('activation_date', datetime.now().isoformat())

# Later retrieval
token = storage.retrieve('license_token')
</code></pre>
<h4 id="7-implement-audit-logging">âœ… 7. Implement Audit Logging</h4>
<pre><code class="language-python">import logging
from datetime import datetime

# Configure secure logging
logging.basicConfig(
    filename='security_audit.log',
    level=logging.INFO,
    format='%(asctime)s - %(levelname)s - %(message)s'
)

def verify_with_audit(bound_token):
    fp = DeviceFingerprinter()

    try:
        is_valid = fp.verify_token(bound_token)

        # Log verification attempt
        logging.info(
            f&quot;License verification: &quot;
            f&quot;valid={is_valid}, &quot;
            f&quot;timestamp={datetime.now().isoformat()}&quot;
        )

        if not is_valid:
            logging.warning(&quot;Invalid license verification attempt&quot;)

        return is_valid

    except Exception as e:
        logging.error(f&quot;Verification error: {e}&quot;, exc_info=True)
        return False
</code></pre>
<h3 id="deployment-security">Deployment Security</h3>
<h4 id="1-code-obfuscation">âœ… 1. Code Obfuscation</h4>
<pre><code class="language-python"># Use PyArmor or similar to obfuscate production code
# pyarmor pack -e &quot;--onefile&quot; your_app.py
</code></pre>
<h4 id="2-secure-distribution">âœ… 2. Secure Distribution</h4>
<ul>
<li>Sign your application packages</li>
<li>Use HTTPS for downloads</li>
<li>Implement code signing certificates</li>
<li>Verify integrity on first run</li>
</ul>
<h4 id="3-update-mechanism">âœ… 3. Update Mechanism</h4>
<pre><code class="language-python">import hashlib
import requests

def secure_update_check():
    &quot;&quot;&quot;Check for updates with signature verification&quot;&quot;&quot;
    # Download update info
    response = requests.get('https://your-server.com/update.json')
    update_info = response.json()

    # Verify signature
    pqc = HybridPQC()
    if not pqc.verify(
        update_info['version_data'],
        update_info['signature']
    ):
        print(&quot;âŒ Invalid update signature!&quot;)
        return False

    # Proceed with update
    # ...
</code></pre>
<hr />
<h2 id="compliance">Compliance</h2>
<h3 id="gdpr-compliance">GDPR Compliance</h3>
<p><strong>Personal Data Considerations:</strong></p>
<p>The library <strong>does not collect or transmit</strong> personal data by default:</p>
<ul>
<li>âœ… Fingerprints are hashed (not reversible)</li>
<li>âœ… No user identification information included</li>
<li>âœ… Hardware IDs are anonymized</li>
<li>âœ… Data stays on local device</li>
</ul>
<p><strong>Your Responsibilities:</strong>
- Inform users about device fingerprinting in privacy policy
- Obtain consent if required by your jurisdiction
- Allow users to request data deletion
- Don't combine fingerprints with personal data without consent</p>
<pre><code class="language-python"># Example: Privacy-compliant implementation
def generate_anonymous_fingerprint():
    &quot;&quot;&quot;Generate fingerprint without personal data&quot;&quot;&quot;
    fp = DeviceFingerprinter(
        include_network=False,  # Don't include MAC addresses
        include_usb=False       # Don't include USB devices
    )

    result = fp.generate()

    # Only use hashed fingerprint
    return result.fingerprint  # Already hashed
</code></pre>
<h3 id="soc-2-iso-27001">SOC 2 / ISO 27001</h3>
<p><strong>Security Controls:</strong></p>
<p><strong>Access Control</strong>
- Cryptographic key protection mechanisms
- Secure storage implementation
- Role-based access control (implemented at application level)</p>
<p><strong>Data Protection</strong>
- Encryption at rest using AES-256-GCM
- Encryption in transit (application's responsibility)
- Secure key derivation with Argon2id</p>
<p><strong>Audit Logging</strong></p>
<pre><code class="language-python"># Implement audit trail
def audit_log(event, details):
    logging.info(
        json.dumps({
            'timestamp': datetime.now().isoformat(),
            'event': event,
            'details': details,
            'user': get_current_user()  # Your implementation
        })
    )
</code></pre>
<p><strong>Vulnerability Management</strong>
- Regular dependency updates recommended
- Security scanning with Bandit and CodeQL
- No known vulnerabilities as of November 2025</p>
<h3 id="pci-dss-payment-card-industry">PCI DSS (Payment Card Industry)</h3>
<p>When implementing for payment security:</p>
<p><strong>Requirement 3</strong>: Protect stored data
- Encrypted storage available
- Key management features provided</p>
<p><strong>Requirement 6</strong>: Secure development
- Follows secure coding practices
- Regular security testing conducted</p>
<p><strong>Requirement 8</strong>: Access control
- Device binding capabilities
- Multi-factor authentication support</p>
<p><strong>Requirement 10</strong>: Audit logging
- Application must implement logging</p>
<hr />
<h2 id="security-checklist">Security Checklist</h2>
<h3 id="pre-deployment-checklist">Pre-Deployment Checklist</h3>
<ul>
<li>[ ] Install PQC libraries (<code>pqcdualusb</code>)</li>
<li>[ ] Implement token binding instead of storing raw keys</li>
<li>[ ] Configure encrypted storage using <code>SecureStorage</code></li>
<li>[ ] Add rate limiting to prevent brute force attacks</li>
<li>[ ] Implement audit logging for security events</li>
<li>[ ] Validate confidence scores before accepting results</li>
<li>[ ] Review error handling to prevent information disclosure</li>
<li>[ ] Consider code obfuscation for sensitive deployments</li>
<li>[ ] Conduct security testing and vulnerability scans</li>
<li>[ ] Update all dependencies to current versions</li>
</ul>
<h3 id="runtime-security-checklist">Runtime Security Checklist</h3>
<ul>
<li>[ ] Monitor and log failed verification attempts</li>
<li>[ ] Maintain comprehensive security event logs</li>
<li>[ ] Configure alerts for anomalous behavior</li>
<li>[ ] Enforce rate limiting on API requests</li>
<li>[ ] Validate and sanitize all user inputs</li>
<li>[ ] Use HTTPS for all network communications</li>
<li>[ ] Establish key rotation schedule</li>
<li>[ ] Implement secure backup procedures</li>
</ul>
<hr />
<h2 id="next-steps">Next Steps</h2>
<ul>
<li><strong>Deployment Guide</strong>: <a href="WIKI_DEPLOYMENT.html">Production Deployment â†’</a></li>
<li><strong>PQC Guide</strong>: <a href="WIKI_PQC.html">Post-Quantum Cryptography â†’</a></li>
<li><strong>HSM Integration</strong>: <a href="WIKI_HSM.md">HSM Guide â†’</a></li>
<li><strong>Monitoring</strong>: <a href="WIKI_MONITORING.md">Analytics Dashboard â†’</a></li>
</ul>
<hr />
<p><strong>Navigation</strong>: <a href="WIKI_HOME.html">â† Home</a> | <a href="WIKI_DEPLOYMENT.html">Deployment â†’</a></p>
                </article>
                <footer class="page-footer">
                    <div class="pager ">
                        <a class="pager-link prev" href="WIKI_QUICK_START.html">&#8592; Quick Start Guide</a>
                        
                    </div>
                </footer>
            </div>
        </section>
    </div>
</body>
</html>
