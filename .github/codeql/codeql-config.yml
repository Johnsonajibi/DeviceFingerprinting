# CodeQL configuration for device-fingerprinting Python package
# https://docs.github.com/en/code-security/code-scanning/automatically-scanning-your-code-for-vulnerabilities-and-errors/configuring-code-scanning

name: python-security-analysis

# Use default queries but focus on security
disable-default-queries: false

# Configure queries to run - focus on Python security
queries:
  - uses: security-and-quality

# Explicitly specify Python-only paths
paths:
  - "src/device_fingerprinting/**/*.py"
  - "tests/**/*.py" 
  - "examples/**/*.py"

# Comprehensive exclusion list
paths-ignore:
  # Documentation and config files
  - '**/*.md'
  - '**/*.rst'
  - '**/*.txt'
  - '**/*.yml'
  - '**/*.yaml'
  - '**/*.json'
  - '**/*.toml'
  - '**/*.cfg'
  - '**/*.ini'
  
  # C/C++ and other compiled languages
  - '**/*.c'
  - '**/*.cpp'
  - '**/*.cc'
  - '**/*.cxx'
  - '**/*.C'
  - '**/*.h'
  - '**/*.hpp'
  - '**/*.hxx'
  - '**/*.H'
  
  # Rust code
  - 'rust/**'
  - '**/*.rs'
  
  # OSS-Fuzz integration
  - 'oss-fuzz/**'
  - 'ossfuzz/**'
  
  # Build and distribution
  - 'build/**'
  - 'dist/**'
  - '**/*.egg-info/**'
  
  # Documentation
  - 'docs/**'
  
  # GitHub workflows (avoid recursion)
  - '.github/**'
  
  # Virtual environments and caches
  - '.venv/**'
  - 'venv/**'
  - '__pycache__/**'
  - '.pytest_cache/**'
  - '.tox/**'
