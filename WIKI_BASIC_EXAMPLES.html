<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Basic Examples | Device Fingerprinting Docs</title>
    <style>
        :root {
            --slate-900: #0f172a;
            --slate-800: #1e293b;
            --slate-700: #334155;
            --slate-600: #475569;
            --slate-200: #e2e8f0;
            --slate-100: #f1f5f9;
            --brand: #2563eb;
            --brand-dark: #1e40af;
            --brand-soft: rgba(37, 99, 235, 0.12);
            --radius-md: 12px;
            --radius-sm: 8px;
            --shadow-lg: 0 24px 60px rgba(15, 23, 42, 0.18);
        }

        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background: linear-gradient(135deg, #0f172a, #111827);
            color: var(--slate-900);
        }

        .page {
            display: grid;
            grid-template-columns: 300px minmax(0, 1fr);
            min-height: 100vh;
        }

        .sidebar {
            position: sticky;
            top: 0;
            align-self: start;
            min-height: 100vh;
            padding: 32px 28px;
            background: linear-gradient(160deg, rgba(30, 64, 175, 0.95), rgba(8, 47, 73, 0.95));
            color: #f8fafc;
            box-shadow: inset -1px 0 0 rgba(148, 163, 184, 0.12);
        }

        .brand {
            font-size: 1.35rem;
            font-weight: 600;
            line-height: 1.4;
            margin-bottom: 28px;
        }

        .brand a {
            color: inherit;
            text-decoration: none;
        }

        .nav-title {
            text-transform: uppercase;
            font-size: 0.72rem;
            letter-spacing: 0.12em;
            margin-bottom: 18px;
            color: rgba(226, 232, 240, 0.7);
        }

        .nav-list {
            list-style: none;
            padding: 0;
            margin: 0;
            display: grid;
            gap: 6px;
        }

        .nav-item a {
            display: block;
            padding: 10px 12px;
            border-radius: var(--radius-sm);
            color: rgba(248, 250, 252, 0.88);
            text-decoration: none;
            font-size: 0.95rem;
            transition: background 0.2s ease, color 0.2s ease;
        }

        .nav-item a:hover {
            background: rgba(148, 163, 184, 0.18);
            color: #fff;
        }

        .nav-item.active a {
            background: rgba(37, 99, 235, 0.95);
            color: #fff;
            box-shadow: 0 10px 25px rgba(37, 99, 235, 0.35);
        }

        .content {
            padding: 56px 72px;
            background: linear-gradient(180deg, rgba(15, 23, 42, 0.02), rgba(15, 23, 42, 0.06));
        }

        .content-inner {
            max-width: 960px;
            margin: 0 auto;
            background: #fff;
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-lg);
            padding: 56px 56px 40px;
        }

        .page-header {
            margin-bottom: 36px;
            border-bottom: 1px solid var(--slate-200);
            padding-bottom: 24px;
        }

        .page-header h1 {
            font-size: 2.2rem;
            margin: 0 0 12px;
            color: var(--slate-900);
        }

        .page-meta {
            font-size: 0.9rem;
            color: var(--slate-600);
        }

        .doc-toc {
            background: var(--slate-100);
            border-radius: var(--radius-md);
            padding: 24px 24px 16px;
            margin-bottom: 32px;
            border: 1px solid rgba(148, 163, 184, 0.3);
        }

        .doc-toc strong {
            display: block;
            font-size: 0.95rem;
            margin-bottom: 12px;
            color: var(--slate-700);
            text-transform: uppercase;
            letter-spacing: 0.08em;
        }

        .doc-toc ul {
            margin: 0;
            padding-left: 20px;
            color: var(--slate-700);
        }

        .doc-toc li {
            margin-bottom: 6px;
        }

        article {
            color: var(--slate-800);
            font-size: 1rem;
            line-height: 1.75;
        }

        article h2 {
            margin-top: 40px;
            margin-bottom: 16px;
            font-size: 1.55rem;
            color: var(--slate-900);
        }

        article h3 {
            margin-top: 28px;
            margin-bottom: 12px;
            font-size: 1.25rem;
            color: var(--slate-800);
        }

        article h4 {
            margin-top: 24px;
            margin-bottom: 10px;
            font-size: 1.05rem;
            color: var(--slate-700);
            text-transform: uppercase;
            letter-spacing: 0.04em;
        }

        article p {
            margin: 0 0 16px;
        }

        article code {
            background: rgba(37, 99, 235, 0.08);
            color: var(--brand-dark);
            padding: 2px 6px;
            border-radius: 6px;
            font-size: 0.92rem;
        }

        pre {
            background: #0f172a;
            color: #f8fafc;
            padding: 20px 24px;
            border-radius: var(--radius-sm);
            overflow-x: auto;
            font-size: 0.95rem;
            line-height: 1.6;
            margin: 24px 0;
        }

        pre code {
            background: none;
            padding: 0;
            color: inherit;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 28px 0;
            border: 1px solid rgba(148, 163, 184, 0.4);
            border-radius: var(--radius-sm);
            overflow: hidden;
        }

        th, td {
            padding: 14px 16px;
            text-align: left;
            border-bottom: 1px solid rgba(148, 163, 184, 0.28);
        }

        th {
            background: var(--brand);
            color: #fff;
            font-weight: 600;
            border-bottom: none;
        }

        tr:nth-child(even) td {
            background: rgba(148, 163, 184, 0.08);
        }

        blockquote {
            margin: 24px 0;
            padding: 18px 24px;
            border-left: 4px solid var(--brand);
            background: var(--brand-soft);
            border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
            color: var(--slate-700);
            font-style: italic;
        }

        a {
            color: var(--brand-dark);
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        .pager {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 48px;
            padding-top: 24px;
            border-top: 1px solid var(--slate-200);
            gap: 16px;
        }

        .pager-link {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 16px;
            border-radius: var(--radius-sm);
            background: rgba(37, 99, 235, 0.08);
            color: var(--brand-dark);
            font-weight: 600;
        }

        .pager-link:hover {
            background: rgba(37, 99, 235, 0.18);
            text-decoration: none;
        }

        .page-footer {
            margin-top: 32px;
            font-size: 0.88rem;
            color: var(--slate-600);
        }

        .no-nav {
            justify-content: flex-end;
        }

        @media (max-width: 1080px) {
            .page {
                grid-template-columns: minmax(0, 1fr);
            }

            .sidebar {
                position: relative;
                min-height: auto;
                border-radius: 0 0 var(--radius-md) var(--radius-md);
            }

            .content {
                padding: 32px 24px;
            }

            .content-inner {
                padding: 36px 26px;
            }
        }
    </style>
</head>
<body>
    <div class="page">
        <aside class="sidebar">
            <div class="brand"><a href="WIKI_HOME.html">Device Fingerprinting Docs</a></div>
            <div class="nav-title">Documentation</div>
            <ul class="nav-list"><li class="nav-item"><a href="WIKI_HOME.html">Device Fingerprinting Library - Documentation</a></li>
<li class="nav-item"><a href="WIKI_API_CORE.html">API Reference - Core</a></li>
<li class="nav-item active"><a href="WIKI_BASIC_EXAMPLES.html">Basic Examples</a></li>
<li class="nav-item"><a href="WIKI_DEPLOYMENT.html">Deployment Guide</a></li>
<li class="nav-item"><a href="WIKI_INSTALLATION.html">Installation Guide</a></li>
<li class="nav-item"><a href="WIKI_PQC.html">Post-Quantum Cryptography (PQC) Guide</a></li>
<li class="nav-item"><a href="WIKI_QUICK_START.html">Quick Start Guide</a></li>
<li class="nav-item"><a href="WIKI_SECURITY.html">Security Architecture</a></li></ul>
        </aside>
        <section class="content">
            <div class="content-inner">
                <header class="page-header">
                    <h1>Basic Examples</h1>
                    <div class="page-meta">Generated on 2025-11-05 20:17</div>
                </header>
                <aside class="doc-toc"><strong>On this page</strong><ul>
<li><a href="#table-of-contents">üìã Table of Contents</a></li>
<li><a href="#software-licensing">Software Licensing</a><ul>
<li><a href="#example-1-basic-license-activation">Example 1: Basic License Activation</a></li>
<li><a href="#example-2-multi-device-license">Example 2: Multi-Device License</a></li>
</ul>
</li>
<li><a href="#user-authentication">User Authentication</a><ul>
<li><a href="#example-3-device-based-mfa">Example 3: Device-Based MFA</a></li>
</ul>
</li>
<li><a href="#session-management">Session Management</a><ul>
<li><a href="#example-4-session-binding">Example 4: Session Binding</a></li>
</ul>
</li>
<li><a href="#fraud-detection">Fraud Detection</a><ul>
<li><a href="#example-5-transaction-monitoring">Example 5: Transaction Monitoring</a></li>
</ul>
</li>
<li><a href="#multi-factor-authentication">Multi-Factor Authentication</a><ul>
<li><a href="#example-6-device-as-second-factor">Example 6: Device as Second Factor</a></li>
</ul>
</li>
<li><a href="#cloud-integration">Cloud Integration</a><ul>
<li><a href="#example-7-license-server-integration">Example 7: License Server Integration</a></li>
</ul>
</li>
<li><a href="#next-steps">Next Steps</a></li>
</ul></aside>
                <article>
                    <p>Practical examples for common use cases of Device Fingerprinting.</p>
<h2 id="table-of-contents">üìã Table of Contents</h2>
<ul>
<li><a href="#software-licensing">Software Licensing</a></li>
<li><a href="#user-authentication">User Authentication</a></li>
<li><a href="#session-management">Session Management</a></li>
<li><a href="#fraud-detection">Fraud Detection</a></li>
<li><a href="#multi-factor-authentication">Multi-Factor Authentication</a></li>
<li><a href="#cloud-integration">Cloud Integration</a></li>
</ul>
<hr />
<h2 id="software-licensing">Software Licensing</h2>
<h3 id="example-1-basic-license-activation">Example 1: Basic License Activation</h3>
<pre><code class="language-python">from device_fingerprinting import DeviceFingerprinter
import json
from datetime import datetime, timedelta

class SimpleLicenseManager:
    def __init__(self):
        self.fingerprinter = DeviceFingerprinter()
        self.license_file = 'license.json'

    def activate(self, license_key):
        &quot;&quot;&quot;Activate license on current device&quot;&quot;&quot;
        # Generate device fingerprint
        result = self.fingerprinter.generate()

        # Bind license to device
        bound_token = self.fingerprinter.bind_token(license_key)

        # Save license data
        license_data = {
            'license_key': license_key,
            'bound_token': bound_token,
            'fingerprint': result.fingerprint,
            'activated_at': datetime.now().isoformat(),
            'expires_at': (datetime.now() + timedelta(days=365)).isoformat()
        }

        with open(self.license_file, 'w') as f:
            json.dump(license_data, f, indent=2)

        print(f&quot;License activated successfully&quot;)
        print(f&quot;   Device fingerprint: {result.fingerprint[:20]}...&quot;)
        print(f&quot;   Confidence: {result.confidence_score:.2%}&quot;)

        return True

    def verify(self):
        &quot;&quot;&quot;Verify license on current device&quot;&quot;&quot;
        try:
            # Load license data
            with open(self.license_file, 'r') as f:
                license_data = json.load(f)

            # Check expiration
            expires_at = datetime.fromisoformat(license_data['expires_at'])
            if datetime.now() &gt; expires_at:
                print(&quot;‚ùå License expired&quot;)
                return False

            # Verify device binding
            is_valid = self.fingerprinter.verify_token(license_data['bound_token'])

            if is_valid:
                print(&quot;License valid&quot;)
                return True
            else:
                print(&quot;License invalid - device mismatch detected&quot;)
                return False

        except FileNotFoundError:
            print(&quot;No license file found&quot;)
            return False
        except Exception as e:
            print(f&quot;Verification error: {e}&quot;)
            return False

# Usage
if __name__ == '__main__':
    manager = SimpleLicenseManager()

    # First time: Activate license
    manager.activate(&quot;ABC-123-XYZ-789&quot;)

    # Every time app starts: Verify license
    if manager.verify():
        print(&quot;Starting application...&quot;)
    else:
        print(&quot;Please activate your license&quot;)
</code></pre>
<h3 id="example-2-multi-device-license">Example 2: Multi-Device License</h3>
<pre><code class="language-python">from device_fingerprinting import DeviceFingerprinter
import json
from datetime import datetime

class MultiDeviceLicense:
    def __init__(self, max_devices=3):
        self.fingerprinter = DeviceFingerprinter()
        self.max_devices = max_devices
        self.license_file = 'multi_device_license.json'

    def _load_licenses(self):
        &quot;&quot;&quot;Load license data&quot;&quot;&quot;
        try:
            with open(self.license_file, 'r') as f:
                return json.load(f)
        except FileNotFoundError:
            return {'devices': [], 'license_key': None}

    def _save_licenses(self, data):
        &quot;&quot;&quot;Save license data&quot;&quot;&quot;
        with open(self.license_file, 'w') as f:
            json.dump(data, f, indent=2)

    def activate(self, license_key):
        &quot;&quot;&quot;Activate license on current device&quot;&quot;&quot;
        data = self._load_licenses()

        # Check if license key changed
        if data['license_key'] and data['license_key'] != license_key:
            print(&quot;‚ùå Different license key&quot;)
            return False

        # Get current device fingerprint
        result = self.fingerprinter.generate()
        current_fp = result.fingerprint

        # Check if device already registered
        for device in data['devices']:
            if device['fingerprint'] == current_fp:
                print(&quot;Device already activated&quot;)
                return True

        # Check device limit
        if len(data['devices']) &gt;= self.max_devices:
            print(f&quot;Maximum device limit reached ({self.max_devices})&quot;)
            return False

        # Register new device
        bound_token = self.fingerprinter.bind_token(license_key)

        device_info = {
            'fingerprint': current_fp,
            'bound_token': bound_token,
            'device_name': self._get_device_name(),
            'activated_at': datetime.now().isoformat()
        }

        data['license_key'] = license_key
        data['devices'].append(device_info)
        self._save_licenses(data)

        print(f&quot;Device activated ({len(data['devices'])}/{self.max_devices} slots used)&quot;)
        return True

    def verify(self):
        &quot;&quot;&quot;Verify license on current device&quot;&quot;&quot;
        data = self._load_licenses()

        if not data['devices']:
            print(&quot;‚ùå No devices activated&quot;)
            return False

        # Get current fingerprint
        result = self.fingerprinter.generate()
        current_fp = result.fingerprint

        # Check if current device is registered
        for device in data['devices']:
            if device['fingerprint'] == current_fp:
                # Verify bound token
                is_valid = self.fingerprinter.verify_token(device['bound_token'])
                if is_valid:
                    print(f&quot;License verified for {device['device_name']}&quot;)
                    return True

        print(&quot;Device not registered&quot;)
        return False

    def list_devices(self):
        &quot;&quot;&quot;List all registered devices&quot;&quot;&quot;
        data = self._load_licenses()

        if not data['devices']:
            print(&quot;No devices registered&quot;)
            return

        print(f&quot;\nRegistered Devices ({len(data['devices'])}/{self.max_devices}):&quot;)
        for i, device in enumerate(data['devices'], 1):
            print(f&quot;  {i}. {device['device_name']}&quot;)
            print(f&quot;     Activated: {device['activated_at']}&quot;)
            print(f&quot;     Fingerprint: {device['fingerprint'][:20]}...&quot;)

    def _get_device_name(self):
        &quot;&quot;&quot;Get friendly device name&quot;&quot;&quot;
        import platform
        return f&quot;{platform.system()}-{platform.node()}&quot;

    def deactivate_device(self, fingerprint):
        &quot;&quot;&quot;Remove a device&quot;&quot;&quot;
        data = self._load_licenses()

        data['devices'] = [
            d for d in data['devices']
            if d['fingerprint'] != fingerprint
        ]

        self._save_licenses(data)
        print(&quot;‚úÖ Device deactivated&quot;)

# Usage
if __name__ == '__main__':
    manager = MultiDeviceLicense(max_devices=3)

    # Activate on current device
    manager.activate(&quot;PRO-LICENSE-KEY&quot;)

    # List devices
    manager.list_devices()

    # Verify
    if manager.verify():
        print(&quot;Application running...&quot;)
</code></pre>
<hr />
<h2 id="user-authentication">User Authentication</h2>
<h3 id="example-3-device-based-mfa">Example 3: Device-Based MFA</h3>
<pre><code class="language-python">from device_fingerprinting import DeviceFingerprinter
import json
from datetime import datetime

class DeviceMFA:
    def __init__(self):
        self.fingerprinter = DeviceFingerprinter()
        self.trusted_devices_file = 'trusted_devices.json'

    def _load_trusted_devices(self):
        &quot;&quot;&quot;Load trusted devices&quot;&quot;&quot;
        try:
            with open(self.trusted_devices_file, 'r') as f:
                return json.load(f)
        except FileNotFoundError:
            return {}

    def _save_trusted_devices(self, data):
        &quot;&quot;&quot;Save trusted devices&quot;&quot;&quot;
        with open(self.trusted_devices_file, 'w') as f:
            json.dump(data, f, indent=2)

    def is_trusted_device(self, user_id):
        &quot;&quot;&quot;Check if current device is trusted&quot;&quot;&quot;
        devices = self._load_trusted_devices()
        user_devices = devices.get(user_id, [])

        # Get current device fingerprint
        result = self.fingerprinter.generate()
        current_fp = result.fingerprint

        # Check if device is trusted
        for device in user_devices:
            if device['fingerprint'] == current_fp:
                print(f&quot;Trusted device: {device['device_name']}&quot;)
                return True

        return False

    def add_trusted_device(self, user_id, device_name=None):
        &quot;&quot;&quot;Add current device as trusted&quot;&quot;&quot;
        devices = self._load_trusted_devices()

        if user_id not in devices:
            devices[user_id] = []

        # Get current device info
        result = self.fingerprinter.generate()

        # Check if already trusted
        for device in devices[user_id]:
            if device['fingerprint'] == result.fingerprint:
                print(&quot;Device already trusted&quot;)
                return False

        # Add device
        device_info = {
            'fingerprint': result.fingerprint,
            'device_name': device_name or 'Unknown Device',
            'added_at': datetime.now().isoformat(),
            'last_seen': datetime.now().isoformat()
        }

        devices[user_id].append(device_info)
        self._save_trusted_devices(devices)

        print(f&quot;Device added to trusted list&quot;)
        return True

    def authenticate(self, user_id, password):
        &quot;&quot;&quot;Authenticate user with device check&quot;&quot;&quot;
        # Step 1: Verify password (your implementation)
        password_valid = self._verify_password(user_id, password)

        if not password_valid:
            print(&quot;‚ùå Invalid password&quot;)
            return False

        # Step 2: Check if device is trusted
        if self.is_trusted_device(user_id):
            print(&quot;Authentication successful (trusted device)&quot;)
            return True
        else:
            print(&quot;New device detected - additional verification required&quot;)
            # Request 2FA code, email confirmation, etc.
            return self._require_additional_verification(user_id)

    def _verify_password(self, user_id, password):
        &quot;&quot;&quot;Verify password (stub)&quot;&quot;&quot;
        # Your password verification logic
        return True

    def _require_additional_verification(self, user_id):
        &quot;&quot;&quot;Request additional verification&quot;&quot;&quot;
        # Send email, SMS, or prompt for 2FA code
        print(&quot;  Please check your email for verification code&quot;)

        # For demo, simulate user entering code
        code = input(&quot;  Enter verification code: &quot;)

        if code == &quot;123456&quot;:  # Your verification logic
            # Add device as trusted
            device_name = input(&quot;  Name this device: &quot;)
            self.add_trusted_device(user_id, device_name)
            return True

        return False

# Usage
if __name__ == '__main__':
    mfa = DeviceMFA()

    # User login
    user_id = &quot;user@example.com&quot;
    password = &quot;user_password&quot;

    if mfa.authenticate(user_id, password):
        print(&quot;‚úÖ Logged in successfully&quot;)
    else:
        print(&quot;‚ùå Authentication failed&quot;)
</code></pre>
<hr />
<h2 id="session-management">Session Management</h2>
<h3 id="example-4-session-binding">Example 4: Session Binding</h3>
<pre><code class="language-python">from device_fingerprinting import DeviceFingerprinter
import secrets
from datetime import datetime, timedelta

class SessionManager:
    def __init__(self):
        self.fingerprinter = DeviceFingerprinter()
        self.sessions = {}  # In production, use database

    def create_session(self, user_id):
        &quot;&quot;&quot;Create session bound to device&quot;&quot;&quot;
        # Generate session ID
        session_id = secrets.token_urlsafe(32)

        # Get device fingerprint
        result = self.fingerprinter.generate()

        # Bind session to device
        bound_session = self.fingerprinter.bind_token(
            session_id,
            metadata={'user_id': user_id}
        )

        # Store session
        self.sessions[session_id] = {
            'user_id': user_id,
            'fingerprint': result.fingerprint,
            'bound_session': bound_session,
            'created_at': datetime.now(),
            'expires_at': datetime.now() + timedelta(hours=24)
        }

        print(f&quot;Session created: {session_id[:16]}...&quot;)
        return session_id

    def validate_session(self, session_id):
        &quot;&quot;&quot;Validate session and device&quot;&quot;&quot;
        if session_id not in self.sessions:
            print(&quot;‚ùå Session not found&quot;)
            return False

        session = self.sessions[session_id]

        # Check expiration
        if datetime.now() &gt; session['expires_at']:
            print(&quot;‚ùå Session expired&quot;)
            del self.sessions[session_id]
            return False

        # Verify device binding
        is_valid = self.fingerprinter.verify_token(session['bound_session'])

        if is_valid:
            print(f&quot;Session validated for user: {session['user_id']}&quot;)
            return True
        else:
            print(&quot;Device mismatch detected - possible session hijacking attempt&quot;)
            return False

    def destroy_session(self, session_id):
        &quot;&quot;&quot;Destroy session&quot;&quot;&quot;
        if session_id in self.sessions:
            del self.sessions[session_id]
            print(&quot;‚úÖ Session destroyed&quot;)

# Usage
if __name__ == '__main__':
    manager = SessionManager()

    # User logs in
    session_id = manager.create_session(&quot;user123&quot;)

    # Later: Validate session
    if manager.validate_session(session_id):
        print(&quot;Access granted&quot;)
    else:
        print(&quot;Access denied&quot;)

    # Logout
    manager.destroy_session(session_id)
</code></pre>
<hr />
<h2 id="fraud-detection">Fraud Detection</h2>
<h3 id="example-5-transaction-monitoring">Example 5: Transaction Monitoring</h3>
<pre><code class="language-python">from device_fingerprinting import DeviceFingerprinter
from datetime import datetime, timedelta
from collections import defaultdict

class FraudDetector:
    def __init__(self):
        self.fingerprinter = DeviceFingerprinter(
            enable_ml=True,
            advanced_mode=True
        )
        self.device_history = defaultdict(list)
        self.risk_threshold = 0.7

    def analyze_transaction(self, user_id, amount, transaction_type):
        &quot;&quot;&quot;Analyze transaction for fraud&quot;&quot;&quot;
        # Generate device fingerprint
        result = self.fingerprinter.generate()

        # Calculate risk score
        risk_score = 0.0
        risk_factors = []

        # Factor 1: New/Unknown device
        known_devices = self.device_history[user_id]
        is_known_device = any(
            d['fingerprint'] == result.fingerprint
            for d in known_devices
        )

        if not is_known_device:
            risk_score += 0.4
            risk_factors.append(&quot;Unknown device&quot;)

        # Factor 2: Low confidence score
        if result.confidence_score &lt; 0.8:
            risk_score += 0.2
            risk_factors.append(&quot;Low confidence hardware&quot;)

        # Factor 3: High transaction amount
        if amount &gt; 1000:
            risk_score += 0.2
            risk_factors.append(&quot;High value transaction&quot;)

        # Factor 4: Unusual timing
        if self._is_unusual_time():
            risk_score += 0.1
            risk_factors.append(&quot;Unusual time&quot;)

        # Factor 5: Multiple devices in short time
        if self._detect_device_switching(user_id):
            risk_score += 0.3
            risk_factors.append(&quot;Multiple devices detected&quot;)

        # Normalize risk score
        risk_score = min(risk_score, 1.0)

        # Record device usage
        self.device_history[user_id].append({
            'fingerprint': result.fingerprint,
            'timestamp': datetime.now(),
            'amount': amount,
            'risk_score': risk_score
        })

        # Determine action
        if risk_score &lt; 0.3:
            action = &quot;ALLOW&quot;
            print(f&quot;Transaction allowed (Risk: {risk_score:.1%})&quot;)
        elif risk_score &lt; self.risk_threshold:
            action = &quot;REVIEW&quot;
            print(f&quot;Transaction flagged for review (Risk: {risk_score:.1%})&quot;)
        else:
            action = &quot;BLOCK&quot;
            print(f&quot;Transaction blocked (Risk: {risk_score:.1%})&quot;)

        return {
            'action': action,
            'risk_score': risk_score,
            'risk_factors': risk_factors,
            'fingerprint': result.fingerprint,
            'confidence': result.confidence_score
        }

    def _is_unusual_time(self):
        &quot;&quot;&quot;Check if transaction is at unusual time&quot;&quot;&quot;
        current_hour = datetime.now().hour
        return current_hour &lt; 6 or current_hour &gt; 23

    def _detect_device_switching(self, user_id):
        &quot;&quot;&quot;Detect rapid device switching&quot;&quot;&quot;
        devices = self.device_history[user_id]

        if len(devices) &lt; 2:
            return False

        # Check last 10 minutes
        recent_window = datetime.now() - timedelta(minutes=10)
        recent_devices = [
            d for d in devices
            if d['timestamp'] &gt; recent_window
        ]

        # Multiple different devices in short time
        unique_fps = set(d['fingerprint'] for d in recent_devices)
        return len(unique_fps) &gt; 2

# Usage
if __name__ == '__main__':
    detector = FraudDetector()

    # Analyze transactions
    result1 = detector.analyze_transaction(
        user_id=&quot;user123&quot;,
        amount=50.00,
        transaction_type=&quot;purchase&quot;
    )

    result2 = detector.analyze_transaction(
        user_id=&quot;user123&quot;,
        amount=1500.00,
        transaction_type=&quot;wire_transfer&quot;
    )

    print(f&quot;\nTransaction 1: {result1['action']}&quot;)
    print(f&quot;Transaction 2: {result2['action']}&quot;)
</code></pre>
<hr />
<h2 id="multi-factor-authentication">Multi-Factor Authentication</h2>
<h3 id="example-6-device-as-second-factor">Example 6: Device as Second Factor</h3>
<pre><code class="language-python">from device_fingerprinting import DeviceFingerprinter
import json

class Device2FA:
    def __init__(self):
        self.fingerprinter = DeviceFingerprinter()
        self.registered_devices_file = '2fa_devices.json'

    def register_device_2fa(self, user_id):
        &quot;&quot;&quot;Register device as 2FA method&quot;&quot;&quot;
        # Load existing registrations
        try:
            with open(self.registered_devices_file, 'r') as f:
                registrations = json.load(f)
        except FileNotFoundError:
            registrations = {}

        # Generate and bind device token
        result = self.fingerprinter.generate()
        device_token = self.fingerprinter.bind_token(user_id)

        # Store registration
        registrations[user_id] = {
            'fingerprint': result.fingerprint,
            'device_token': device_token,
            'registered_at': datetime.now().isoformat()
        }

        with open(self.registered_devices_file, 'w') as f:
            json.dump(registrations, f, indent=2)

        print(&quot;Device registered for 2FA&quot;)
        return True

    def verify_2fa(self, user_id):
        &quot;&quot;&quot;Verify using device as second factor&quot;&quot;&quot;
        # Load registrations
        try:
            with open(self.registered_devices_file, 'r') as f:
                registrations = json.load(f)
        except FileNotFoundError:
            print(&quot;‚ùå No 2FA device registered&quot;)
            return False

        if user_id not in registrations:
            print(&quot;‚ùå User not registered for device 2FA&quot;)
            return False

        # Verify device token
        device_token = registrations[user_id]['device_token']
        is_valid = self.fingerprinter.verify_token(device_token)

        if is_valid:
            print(&quot;2FA verification successful&quot;)
            return True
        else:
            print(&quot;2FA verification failed - device mismatch&quot;)
            return False

# Usage
if __name__ == '__main__':
    twofa = Device2FA()

    user_id = &quot;user@example.com&quot;

    # First time: Register device
    twofa.register_device_2fa(user_id)

    # Login: Verify 2FA
    # Step 1: Username/Password (your implementation)
    # Step 2: Device verification
    if twofa.verify_2fa(user_id):
        print(&quot;‚úÖ Login successful&quot;)
    else:
        print(&quot;‚ùå 2FA failed&quot;)
</code></pre>
<hr />
<h2 id="cloud-integration">Cloud Integration</h2>
<h3 id="example-7-license-server-integration">Example 7: License Server Integration</h3>
<pre><code class="language-python">from device_fingerprinting import DeviceFingerprinter
import requests
import json

class CloudLicenseClient:
    def __init__(self, api_url):
        self.fingerprinter = DeviceFingerprinter()
        self.api_url = api_url

    def activate_online(self, license_key):
        &quot;&quot;&quot;Activate license with cloud verification&quot;&quot;&quot;
        # Generate device fingerprint
        result = self.fingerprinter.generate()

        # Send activation request to server
        response = requests.post(
            f&quot;{self.api_url}/activate&quot;,
            json={
                'license_key': license_key,
                'fingerprint': result.fingerprint,
                'hardware_info': {
                    'confidence': result.confidence_score,
                    'components': result.components_used
                }
            },
            timeout=10
        )

        if response.status_code == 200:
            data = response.json()

            # Store activation token
            with open('license.json', 'w') as f:
                json.dump({
                    'license_key': license_key,
                    'activation_token': data['activation_token'],
                    'fingerprint': result.fingerprint
                }, f)

            print(&quot;License activated successfully&quot;)
            return True
        else:
            print(f&quot;Activation failed: {response.json().get('error')}&quot;)
            return False

    def verify_online(self):
        &quot;&quot;&quot;Verify license with cloud server&quot;&quot;&quot;
        # Load license
        try:
            with open('license.json', 'r') as f:
                license_data = json.load(f)
        except FileNotFoundError:
            print(&quot;‚ùå No license found&quot;)
            return False

        # Get current fingerprint
        result = self.fingerprinter.generate()

        # Verify with server
        response = requests.post(
            f&quot;{self.api_url}/verify&quot;,
            json={
                'activation_token': license_data['activation_token'],
                'fingerprint': result.fingerprint
            },
            timeout=10
        )

        if response.status_code == 200:
            data = response.json()
            if data['valid']:
                print(&quot;License verified successfully&quot;)
                return True

        print(&quot;License verification failed&quot;)
        return False

# Usage
if __name__ == '__main__':
    client = CloudLicenseClient(&quot;https://your-license-server.com/api&quot;)

    # Activate
    if client.activate_online(&quot;LICENSE-KEY-HERE&quot;):
        print(&quot;Starting application...&quot;)

    # Verify (e.g., on app startup)
    if client.verify_online():
        print(&quot;Application running...&quot;)
</code></pre>
<hr />
<h2 id="next-steps">Next Steps</h2>
<ul>
<li><strong>API Reference</strong>: <a href="WIKI_API_CORE.html">Core API ‚Üí</a></li>
<li><strong>Advanced Features</strong>: <a href="WIKI_PQC.html">PQC Guide ‚Üí</a></li>
<li><strong>Production Deployment</strong>: <a href="WIKI_DEPLOYMENT.html">Deployment Guide ‚Üí</a></li>
</ul>
<hr />
<p><strong>Navigation</strong>: <a href="WIKI_QUICK_START.html">‚Üê Quick Start</a> | <a href="WIKI_HOME.html">Home</a> | <a href="WIKI_API_CORE.html">API ‚Üí</a></p>
                </article>
                <footer class="page-footer">
                    <div class="pager ">
                        <a class="pager-link prev" href="WIKI_API_CORE.html">&#8592; API Reference - Core</a>
                        <a class="pager-link next" href="WIKI_DEPLOYMENT.html">Deployment Guide &#8594;</a>
                    </div>
                </footer>
            </div>
        </section>
    </div>
</body>
</html>
